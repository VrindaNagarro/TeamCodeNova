<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/com/nagarro/driven/utils/ExcelReader.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/nagarro/driven/utils/ExcelReader.java" />
              <option name="originalContent" value="package com.nagarro.driven.utils;&#10;&#10;import org.apache.poi.ss.usermodel.*;&#10;import org.apache.poi.xssf.usermodel.XSSFWorkbook;&#10;&#10;import java.io.FileInputStream;&#10;import java.io.IOException;&#10;import java.util.*;&#10;&#10;public class ExcelReader {&#10;&#10;    private final String filePath;&#10;&#10;    public ExcelReader(String filePath) {&#10;        this.filePath = filePath;&#10;    }&#10;&#10;    /**&#10;     * Reads the entire sheet and returns data as a List of Map&lt;String, String&gt;.&#10;     * Each row becomes a Map with column headers as keys.&#10;     */&#10;    public List&lt;Map&lt;String, String&gt;&gt; getData(String sheetName) {&#10;        List&lt;Map&lt;String, String&gt;&gt; data = new ArrayList&lt;&gt;();&#10;&#10;        try (FileInputStream fis = new FileInputStream(filePath);&#10;             Workbook workbook = new XSSFWorkbook(fis)) {&#10;&#10;            Sheet sheet = workbook.getSheet(sheetName);&#10;            if (sheet == null) {&#10;                throw new RuntimeException(&quot;Sheet \&quot;&quot; + sheetName + &quot;\&quot; not found in file: &quot; + filePath);&#10;            }&#10;&#10;            // Get header row&#10;            Row headerRow = sheet.getRow(0);&#10;            if (headerRow == null) {&#10;                throw new RuntimeException(&quot;Header row missing in sheet: &quot; + sheetName);&#10;            }&#10;&#10;            int lastRowNum = sheet.getLastRowNum();&#10;            int totalCols = headerRow.getLastCellNum();&#10;&#10;            // Loop through rows (skip header)&#10;            for (int i = 1; i &lt;= lastRowNum; i++) {&#10;                Row currentRow = sheet.getRow(i);&#10;                if (currentRow == null) continue;&#10;&#10;                Map&lt;String, String&gt; rowData = new LinkedHashMap&lt;&gt;();&#10;                for (int j = 0; j &lt; totalCols; j++) {&#10;                    String header = getCellValue(headerRow.getCell(j));&#10;                    String value = getCellValue(currentRow.getCell(j));&#10;                    rowData.put(header, value);&#10;                }&#10;                data.add(rowData);&#10;            }&#10;&#10;        } catch (IOException e) {&#10;            throw new RuntimeException(&quot;Failed to read Excel file: &quot; + e.getMessage(), e);&#10;        }&#10;&#10;        return data;&#10;    }&#10;&#10;    /**&#10;     * Get a single cell value by sheet, row, and column index.&#10;     */&#10;    public String getCellData(String sheetName, int rowNum, int colNum) {&#10;        try (FileInputStream fis = new FileInputStream(filePath);&#10;             Workbook workbook = new XSSFWorkbook(fis)) {&#10;&#10;            Sheet sheet = workbook.getSheet(sheetName);&#10;            if (sheet == null) throw new RuntimeException(&quot;Sheet not found: &quot; + sheetName);&#10;&#10;            Row row = sheet.getRow(rowNum);&#10;            if (row == null) return &quot;&quot;;&#10;&#10;            Cell cell = row.getCell(colNum);&#10;            return getCellValue(cell);&#10;&#10;        } catch (IOException e) {&#10;            throw new RuntimeException(&quot;Failed to get cell data: &quot; + e.getMessage(), e);&#10;        }&#10;    }&#10;&#10;    private String getCellValue(Cell cell) {&#10;        if (cell == null) return &quot;&quot;;&#10;        DataFormatter formatter = new DataFormatter();&#10;        return formatter.formatCellValue(cell);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.nagarro.driven.utils;&#10;&#10;import org.apache.poi.ss.usermodel.*;&#10;import org.apache.poi.xssf.usermodel.XSSFWorkbook;&#10;&#10;import java.io.FileInputStream;&#10;import java.io.IOException;&#10;import java.util.*;&#10;&#10;public class ExcelReader {&#10;&#10;    private final String filePath;&#10;&#10;    public ExcelReader(String filePath) {&#10;        this.filePath = filePath;&#10;    }&#10;&#10;    /**&#10;     * Reads the entire sheet and returns data as a List of Map&lt;String, String&gt;.&#10;     * Each row becomes a Map with column headers as keys.&#10;     */&#10;    public List&lt;Map&lt;String, String&gt;&gt; getData(String sheetName) {&#10;        List&lt;Map&lt;String, String&gt;&gt; data = new ArrayList&lt;&gt;();&#10;&#10;        try (FileInputStream fis = new FileInputStream(filePath);&#10;             Workbook workbook = new XSSFWorkbook(fis)) {&#10;&#10;            Sheet sheet = workbook.getSheet(sheetName);&#10;            if (sheet == null) {&#10;                throw new RuntimeException(&quot;Sheet \&quot;&quot; + sheetName + &quot;\&quot; not found in file: &quot; + filePath);&#10;            }&#10;&#10;            // Get header row&#10;            Row headerRow = sheet.getRow(0);&#10;            if (headerRow == null) {&#10;                throw new RuntimeException(&quot;Header row missing in sheet: &quot; + sheetName);&#10;            }&#10;&#10;            int lastRowNum = sheet.getLastRowNum();&#10;            int totalCols = headerRow.getLastCellNum();&#10;&#10;            // Loop through rows (skip header)&#10;            for (int i = 1; i &lt;= lastRowNum; i++) {&#10;                Row currentRow = sheet.getRow(i);&#10;                if (currentRow == null) continue;&#10;&#10;                Map&lt;String, String&gt; rowData = new LinkedHashMap&lt;&gt;();&#10;                for (int j = 0; j &lt; totalCols; j++) {&#10;                    String header = getCellValue(headerRow.getCell(j));&#10;                    String value = getCellValue(currentRow.getCell(j));&#10;                    rowData.put(header, value);&#10;                }&#10;                data.add(rowData);&#10;            }&#10;&#10;        } catch (IOException e) {&#10;            throw new RuntimeException(&quot;Failed to read Excel file: &quot; + e.getMessage(), e);&#10;        }&#10;&#10;        return data;&#10;    }&#10;&#10;    /**&#10;     * Read data from the first sheet of the workbook. Useful when sheet name is unknown.&#10;     */&#10;    public List&lt;Map&lt;String, String&gt;&gt; getDataFirstSheet() {&#10;        List&lt;Map&lt;String, String&gt;&gt; data = new ArrayList&lt;&gt;();&#10;&#10;        try (FileInputStream fis = new FileInputStream(filePath);&#10;             Workbook workbook = new XSSFWorkbook(fis)) {&#10;&#10;            Sheet sheet = workbook.getSheetAt(0);&#10;            if (sheet == null) {&#10;                throw new RuntimeException(&quot;No sheets found in file: &quot; + filePath);&#10;            }&#10;&#10;            Row headerRow = sheet.getRow(0);&#10;            if (headerRow == null) {&#10;                throw new RuntimeException(&quot;Header row missing in first sheet of file: &quot; + filePath);&#10;            }&#10;&#10;            int lastRowNum = sheet.getLastRowNum();&#10;            int totalCols = headerRow.getLastCellNum();&#10;&#10;            for (int i = 1; i &lt;= lastRowNum; i++) {&#10;                Row currentRow = sheet.getRow(i);&#10;                if (currentRow == null) continue;&#10;&#10;                Map&lt;String, String&gt; rowData = new LinkedHashMap&lt;&gt;();&#10;                for (int j = 0; j &lt; totalCols; j++) {&#10;                    String header = getCellValue(headerRow.getCell(j));&#10;                    String value = getCellValue(currentRow.getCell(j));&#10;                    rowData.put(header, value);&#10;                }&#10;                data.add(rowData);&#10;            }&#10;&#10;        } catch (IOException e) {&#10;            throw new RuntimeException(&quot;Failed to read Excel file (first sheet): &quot; + e.getMessage(), e);&#10;        }&#10;&#10;        return data;&#10;    }&#10;&#10;    /**&#10;     * Get a single cell value by sheet, row, and column index.&#10;     */&#10;    public String getCellData(String sheetName, int rowNum, int colNum) {&#10;        try (FileInputStream fis = new FileInputStream(filePath);&#10;             Workbook workbook = new XSSFWorkbook(fis)) {&#10;&#10;            Sheet sheet = workbook.getSheet(sheetName);&#10;            if (sheet == null) throw new RuntimeException(&quot;Sheet not found: &quot; + sheetName);&#10;&#10;            Row row = sheet.getRow(rowNum);&#10;            if (row == null) return &quot;&quot;;&#10;&#10;            Cell cell = row.getCell(colNum);&#10;            return getCellValue(cell);&#10;&#10;        } catch (IOException e) {&#10;            throw new RuntimeException(&quot;Failed to get cell data: &quot; + e.getMessage(), e);&#10;        }&#10;    }&#10;&#10;    private String getCellValue(Cell cell) {&#10;        if (cell == null) return &quot;&quot;;&#10;        DataFormatter formatter = new DataFormatter();&#10;        return formatter.formatCellValue(cell);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>